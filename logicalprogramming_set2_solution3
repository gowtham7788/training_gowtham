#include<stdio.h>
#include<conio.h>
#include<string.h>
int g_strength;
struct stud{
	float cgpa;
	int year;
	char name[15];
	char dept[20];
}s[10];

int get_int(){
	int num=0;
	int ret=0;
	ret=scanf("%d",&num);
	if (ret!=1){
	printf("enter valid number");
	scanf("%s");
	num= get_int();
	}  //recall the function if char is entered instead of int
	else if (num<0){
	printf("enter positive number ");
	num= get_int();
	}  //recall the function if negative number is entered instead of positive
return num;
}

float get_float()
{
	float num=0.0;
	int ret=0;
	ret=scanf("%f",&num);
	if (ret!=1){
	printf("\nenter valid number");
	scanf("%s");
	num=get_float();
	}  //recall the function if char is entered instead of float

	else if (num<0){
	printf("\nenter positive number ");
	num=get_float();
	}  //recall the function if negative number is entered instead of positive
return num;
}

void namesFromYear(){
	int year1,i,flag=0;
	printf("\nEnter the year ");
	year1=get_int();
	for (i=0;i<g_strength;i++){
		if (s[i].year==year1){    //if year is matched then print the names
			printf("\n%s",s[i].name);
			flag=1;
		}
	}
	if (flag==0){
		printf("No names are available");
	}
}

void namesFromDept(){
	int i,flag=0;
	char ch[20];
	printf("Enter the department ");
	scanf("%s",&ch);
	for (i=0;i<g_strength;i++){
		if (strcmp(ch,s[i].dept)==0){  //if department is matched then print the names
			printf("\n%s",s[i].name);
			flag=1;
		}
	}
	if (flag==0){
		printf("No names are available");
	}
}

void detailsHavingHighCGPA(){
	int i,p;
	float hcgpa=0.0;
	for (i=0;i<g_strength;i++){
		if (hcgpa<s[i].cgpa){
			hcgpa=s[i].cgpa;  //calculate highest CGPA
			p=i;
		}
	}
	printf("\nOverall highest CGPA\nName %s\nDept %s\nCGPA %f\nYear %d",s[p].name,s[p].dept,s[p].cgpa,s[p].year);
}

void detailsFromDeptHavingHighCGPA(){
	int i,p;
	float hcgpa=0.0;
	char dep[20];
	printf("Enter the dept ");
	scanf("%s",&dep);
	for (i=0;i<g_strength;i++){         //calculate highest CGPA under particular department
		if (strcmp(dep,s[i].dept)==0){
			if (hcgpa<s[i].cgpa){
				hcgpa=s[i].cgpa;
				p=i;
			}
		}
	}
	printf("\nHighest CGPA in dept\nName %s\nDept %s\nCGPA %f\nYear %d",s[p].name,s[p].dept,s[p].cgpa,s[p].year);
}

void detailsOfStud(){
	int i;
	char nam[20];
	printf("Enter the name ");
	scanf("%s",&nam);
	for (i=0;i<g_strength;i++){  //display details of particular student
		if (strcmp(nam,s[i].name)==0){
			printf("\nName %s\nDept %s\nCGPA %f\nYear %d",s[i].name,s[i].dept,s[i].cgpa,s[i].year);
			break;
		}
	}
}

void displayAllDetails(){
	int i;
	printf("\nAll details of all students\nName \tDept \tCGPA \tYear ");
	for (i=0;i<g_strength;i++){
		printf("\n%s\t%s\t%f\t%d",s[i].name,s[i].dept,s[i].cgpa,s[i].year);
	}
}

void updateCGPA(){
	int i;
	char nam[10];
	printf("\nEnter student name to update CGPA ");
	scanf("%s",&nam);
	for (i=0;i<g_strength;i++){
		if (strcmp(nam,s[i].name)==0){
			s[i].cgpa+=0.5;       //update CGPA
			printf("\nUpdated successfully");
			break;
		}
	}
}

void get_info(int strength){
	char temp[15];
	float t;
	int i=0;
	int j=0;
	int k=0;
	for (i=0;i<strength;i++){
	printf("Enter name dept cgpa year of the student %d \n",i+1);
	scanf("%s",&s[i].name);
	scanf("%s",&s[i].dept);
	s[i].cgpa=get_float();
	s[i].year=get_int();
	}
	for(i=0;i<g_strength-1;i++){
		for(j=i+1;j<strength;j++){
			if (strcmp(s[i].name,s[j].name)>0){
				strcpy(temp,s[i].name);
				strcpy(s[i].name,s[j].name);
				strcpy(s[j].name,temp);
				strcpy(temp,s[i].dept);
				strcpy(s[i].dept,s[j].dept);
				strcpy(s[j].dept,temp);
				t=s[i].cgpa;
				s[i].cgpa=s[j].cgpa;
				s[j].cgpa=t;
				k=s[i].year;
				s[i].year=s[j].year;
				s[j].year=k;
			}
		}
	}
}

void main(){
	int choice;
	clrscr();
	printf("Enter number of student ");
	g_strength=get_int();
	get_info(g_strength);
	printf("\n1.Display names of students from particular year");
	printf("\n2.Display names of students from particular department");
	printf("\n3.Display all details of the student having highest CGPA");
	printf("\n4.Display all details of the student from particular dept having highest CGPA");
	printf("\n5.Display all details of particular student");
	printf("\n6.Display all details of all student");
	printf("\n7.Update CGPA of a particular student");
	printf("\n8.Exit");
	printf("\nEnter your Choice ");
	choice=get_int();
	do {
		switch (choice){
			case 1:namesFromYear();break;
			case 2:namesFromDept();break;
			case 3:detailsHavingHighCGPA();break;
			case 4:detailsFromDeptHavingHighCGPA();break;
			case 5:detailsOfStud();break;
			case 6:displayAllDetails();break;
			case 7:updateCGPA();break;
			case 8:exit(0);break;
			default: printf("\nInvalid Choice ");
		}
	printf("\nEnter your Choice ");
	choice=get_int();
	}while(choice!=8);
}
